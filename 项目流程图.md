# æ‰‹å†™ç®¡ç†åŠ©æ‰‹ - æ•´ä½“æµç¨‹å›¾

## é¡¹ç›®å®Œæ•´ä¸šåŠ¡æµç¨‹ï¼ˆé€‚åˆå±•ç¤ºï¼‰

```mermaid
flowchart TB
    Start([ç”¨æˆ·è®¿é—®åº”ç”¨]):::startEnd
    
    subgraph Auth["ğŸ” ç”¨æˆ·è®¤è¯æ¨¡å—"]
        direction TB
        A1{æ˜¯å¦ç™»å½•?}
        A2[ç™»å½•/æ³¨å†Œé¡µé¢]
        A3[JWTè®¤è¯]
        A4[Tokenå­˜å‚¨]
    end
    
    subgraph Upload["ğŸ“¤ æ–‡ä»¶ä¸Šä¼ æ¨¡å—"]
        direction TB
        U1[æ‹ç…§/é€‰æ‹©å›¾ç‰‡]
        U2[æ–‡ä»¶éªŒè¯]
        U3[ä¸Šä¼ åˆ°æœåŠ¡å™¨]
        U4[ä¿å­˜æ–‡ä»¶è®°å½•]
    end
    
    subgraph OCR["ğŸ” OCRè¯†åˆ«æ¨¡å—"]
        direction TB
        O1[PaddleOCRå¼•æ“]
        O2[æ–‡å­—è¯†åˆ«]
        O3[ç»“æœé¢„è§ˆ]
        O4[ç”¨æˆ·ç¼–è¾‘ç¡®è®¤]
    end
    
    subgraph Classify["ğŸ¤– AIåˆ†ç±»æ¨¡å—"]
        direction TB
        C1{LLMå¯ç”¨?}
        C2[LLMæ™ºèƒ½åˆ†ç±»]
        C3[è§„åˆ™åˆ†ç±»]
        C4{ç½®ä¿¡åº¦æ£€æŸ¥}
        C5[è‡ªåŠ¨åˆ†ç±»]
        C6[æ‰‹åŠ¨é€‰æ‹©]
    end
    
    subgraph Save["ğŸ’¾ æ•°æ®ä¿å­˜æ¨¡å—"]
        direction TB
        S1{åˆ†ç±»ç±»å‹}
        S2[ä¿å­˜ä¸ºæ—¥ç¨‹]
        S3[ä¿å­˜ä¸ºå¤‡å¿˜å½•]
        S4[(SQLiteæ•°æ®åº“)]
    end
    
    subgraph Manage["ğŸ“‹ ç®¡ç†æ¨¡å—"]
        direction TB
        M1[æ—¥ç¨‹ç®¡ç†]
        M2[å¤‡å¿˜å½•ç®¡ç†]
        M3[å…¨æ–‡æœç´¢]
        M4[ç­›é€‰æ’åº]
        M5[ç¼–è¾‘åˆ é™¤]
    end
    
    subgraph Tech["âš™ï¸ æŠ€æœ¯æ ˆ"]
        direction LR
        T1[Vue 3 + TS]
        T2[FastAPI]
        T3[PaddleOCR]
        T4[LLMæœåŠ¡]
        T5[SQLAlchemy]
    end
    
    Start --> A1
    A1 -->|æœªç™»å½•| A2
    A1 -->|å·²ç™»å½•| Upload
    A2 --> A3
    A3 --> A4
    A4 --> Upload
    
    U1 --> U2
    U2 --> U3
    U3 --> U4
    U4 --> OCR
    
    O1 --> O2
    O2 --> O3
    O3 --> O4
    O4 --> Classify
    
    C1 -->|æ˜¯| C2
    C1 -->|å¦| C3
    C2 --> C4
    C3 --> C4
    C4 -->|é«˜ç½®ä¿¡åº¦| C5
    C4 -->|ä½ç½®ä¿¡åº¦| C6
    C5 --> Save
    C6 --> Save
    
    S1 -->|æ—¥ç¨‹| S2
    S1 -->|å¤‡å¿˜å½•| S3
    S2 --> S4
    S3 --> S4
    S4 --> Manage
    
    M1 --> M4
    M2 --> M4
    M3 --> M4
    M4 --> M5
    M5 --> End([å®Œæˆ]):::startEnd
    
    Tech -.æŠ€æœ¯æ”¯æ’‘.-> Auth
    Tech -.æŠ€æœ¯æ”¯æ’‘.-> Upload
    Tech -.æŠ€æœ¯æ”¯æ’‘.-> OCR
    Tech -.æŠ€æœ¯æ”¯æ’‘.-> Classify
    Tech -.æŠ€æœ¯æ”¯æ’‘.-> Save
    Tech -.æŠ€æœ¯æ”¯æ’‘.-> Manage
    
    classDef startEnd fill:#4CAF50,stroke:#2E7D32,stroke-width:3px,color:#fff
    classDef authStyle fill:#2196F3,stroke:#1565C0,stroke-width:2px,color:#fff
    classDef uploadStyle fill:#FF9800,stroke:#E65100,stroke-width:2px,color:#fff
    classDef ocrStyle fill:#9C27B0,stroke:#6A1B9A,stroke-width:2px,color:#fff
    classDef classifyStyle fill:#00BCD4,stroke:#006064,stroke-width:2px,color:#fff
    classDef saveStyle fill:#4CAF50,stroke:#2E7D32,stroke-width:2px,color:#fff
    classDef manageStyle fill:#FF5722,stroke:#BF360C,stroke-width:2px,color:#fff
    classDef techStyle fill:#607D8B,stroke:#37474F,stroke-width:2px,color:#fff
    
    class A1,A2,A3,A4 authStyle
    class U1,U2,U3,U4 uploadStyle
    class O1,O2,O3,O4 ocrStyle
    class C1,C2,C3,C4,C5,C6 classifyStyle
    class S1,S2,S3,S4 saveStyle
    class M1,M2,M3,M4,M5 manageStyle
    class T1,T2,T3,T4,T5 techStyle
```

---

## ç³»ç»Ÿæ¶æ„å›¾ï¼ˆæŠ€æœ¯è§†è§’ï¼‰

```mermaid
graph TB
    subgraph Client["ğŸ‘¤ å®¢æˆ·ç«¯å±‚"]
        Browser[Webæµè§ˆå™¨<br/>Vue 3 + TypeScript]
        Mobile[ç§»åŠ¨è®¾å¤‡<br/>å“åº”å¼è®¾è®¡]
    end
    
    subgraph Frontend["ğŸ¨ å‰ç«¯å±‚ - Port 5173"]
        VueApp[Vue 3 åº”ç”¨]
        Router[Vue Router<br/>è·¯ç”±ç®¡ç†]
        Pinia[Pinia Store<br/>çŠ¶æ€ç®¡ç†]
        Axios[Axios<br/>HTTPå®¢æˆ·ç«¯]
        Tailwind[Tailwind CSS<br/>æ ·å¼æ¡†æ¶]
    end
    
    subgraph Backend["âš™ï¸ åç«¯å±‚ - Port 8000"]
        FastAPI[FastAPI æ¡†æ¶]
        
        subgraph APIs["APIè·¯ç”±"]
            AuthAPI[è®¤è¯API<br/>/auth]
            UploadAPI[ä¸Šä¼ API<br/>/upload]
            OCRAPI[OCR API<br/>/ocr]
            ClassifyAPI[åˆ†ç±»API<br/>/classify]
            ScheduleAPI[æ—¥ç¨‹API<br/>/schedules]
            MemoAPI[å¤‡å¿˜å½•API<br/>/memos]
        end
        
        subgraph Services["ä¸šåŠ¡æœåŠ¡"]
            JWTService[JWTè®¤è¯æœåŠ¡]
            OCRService[OCRè¯†åˆ«æœåŠ¡<br/>PaddleOCR]
            ClassifyService[åˆ†ç±»æœåŠ¡<br/>LLM + è§„åˆ™]
        end
        
        subgraph ORM["æ•°æ®è®¿é—®å±‚"]
            SQLAlchemy[SQLAlchemy ORM]
        end
    end
    
    subgraph Data["ğŸ’¾ æ•°æ®å±‚"]
        DB[(SQLite/MySQL<br/>æ•°æ®åº“)]
        FileStorage[æ–‡ä»¶å­˜å‚¨<br/>uploads/]
        Logs[æ—¥å¿—æ–‡ä»¶<br/>logs/]
    end
    
    Browser --> VueApp
    Mobile --> VueApp
    
    VueApp --> Router
    VueApp --> Pinia
    VueApp --> Tailwind
    Router --> Axios
    Pinia --> Axios
    
    Axios -->|HTTP/REST| FastAPI
    
    FastAPI --> AuthAPI
    FastAPI --> UploadAPI
    FastAPI --> OCRAPI
    FastAPI --> ClassifyAPI
    FastAPI --> ScheduleAPI
    FastAPI --> MemoAPI
    
    AuthAPI --> JWTService
    OCRAPI --> OCRService
    ClassifyAPI --> ClassifyService
    
    AuthAPI --> SQLAlchemy
    ScheduleAPI --> SQLAlchemy
    MemoAPI --> SQLAlchemy
    UploadAPI --> SQLAlchemy
    
    SQLAlchemy --> DB
    OCRService --> FileStorage
    UploadAPI --> FileStorage
    FastAPI --> Logs
    
    style Browser fill:#42b883,stroke:#2c3e50,stroke-width:2px,color:#fff
    style FastAPI fill:#009688,stroke:#004d40,stroke-width:3px,color:#fff
    style DB fill:#ff9800,stroke:#e65100,stroke-width:2px,color:#fff
    style OCRService fill:#9c27b0,stroke:#4a148c,stroke-width:2px,color:#fff
    style ClassifyService fill:#00bcd4,stroke:#006064,stroke-width:2px,color:#fff
```

---

## æ•°æ®æµå‘å›¾

```mermaid
flowchart LR
    User([ğŸ‘¤ ç”¨æˆ·])
    
    subgraph FE["å‰ç«¯ Vue App"]
        UI[ç”¨æˆ·ç•Œé¢]
        Store[çŠ¶æ€ç®¡ç†]
        API[APIå®¢æˆ·ç«¯]
    end
    
    subgraph BE["åç«¯ FastAPI"]
        Route[è·¯ç”±å±‚]
        Service[æœåŠ¡å±‚]
        Model[æ¨¡å‹å±‚]
    end
    
    subgraph DB["æ•°æ®å­˜å‚¨"]
        Database[(æ•°æ®åº“)]
        Files[æ–‡ä»¶ç³»ç»Ÿ]
    end
    
    User -->|äº¤äº’| UI
    UI <-->|çŠ¶æ€| Store
    Store <-->|è¯·æ±‚/å“åº”| API
    API <-->|HTTP REST| Route
    Route <-->|ä¸šåŠ¡é€»è¾‘| Service
    Service <-->|æ•°æ®æ“ä½œ| Model
    Model <-->|è¯»å†™| Database
    Service <-->|æ–‡ä»¶æ“ä½œ| Files
    
    style User fill:#4CAF50,stroke:#2E7D32,stroke-width:3px
    style FE fill:#2196F3,stroke:#1565C0,stroke-width:2px
    style BE fill:#FF9800,stroke:#E65100,stroke-width:2px
    style DB fill:#9C27B0,stroke:#6A1B9A,stroke-width:2px
```

---

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—å…³ç³»å›¾

```mermaid
mindmap
  root((æ‰‹å†™ç®¡ç†åŠ©æ‰‹))
    ç”¨æˆ·è®¤è¯
      æ³¨å†Œç™»å½•
      JWT Token
      æƒé™æ§åˆ¶
    æ–‡ä»¶å¤„ç†
      å›¾ç‰‡ä¸Šä¼ 
      æ–‡ä»¶éªŒè¯
      å­˜å‚¨ç®¡ç†
    OCRè¯†åˆ«
      PaddleOCRå¼•æ“
      æ–‡å­—æå–
      ç»“æœç¼–è¾‘
    AIåˆ†ç±»
      LLMæ™ºèƒ½åˆ†ç±»
      è§„åˆ™åˆ†ç±»
      ç½®ä¿¡åº¦åˆ¤æ–­
      æ‰‹åŠ¨é€‰æ‹©
    æ—¥ç¨‹ç®¡ç†
      åˆ›å»ºæ—¥ç¨‹
      æŸ¥çœ‹åˆ—è¡¨
      ç­›é€‰æ’åº
      ç¼–è¾‘åˆ é™¤
    å¤‡å¿˜å½•ç®¡ç†
      åˆ›å»ºå¤‡å¿˜å½•
      æ ‡ç­¾ç®¡ç†
      å…¨æ–‡æœç´¢
      ç¼–è¾‘åˆ é™¤
    æ•°æ®åŒæ­¥
      è·¨ç«¯åŒæ­¥
      æ•°æ®æŒä¹…åŒ–
      çŠ¶æ€ç®¡ç†
```

---

## 2. ç”¨æˆ·è®¤è¯æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant FE as å‰ç«¯
    participant API as åç«¯API
    participant DB as æ•°æ®åº“
    
    rect rgb(200, 220, 240)
        Note over U,DB: ç”¨æˆ·æ³¨å†Œæµç¨‹
        U->>FE: è¾“å…¥æ³¨å†Œä¿¡æ¯
        FE->>API: POST /api/v1/auth/register
        API->>DB: æ£€æŸ¥ç”¨æˆ·å/é‚®ç®±æ˜¯å¦å­˜åœ¨
        alt ç”¨æˆ·å·²å­˜åœ¨
            DB-->>API: ç”¨æˆ·å·²å­˜åœ¨
            API-->>FE: 400 é”™è¯¯
            FE-->>U: æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        else ç”¨æˆ·ä¸å­˜åœ¨
            API->>DB: åˆ›å»ºæ–°ç”¨æˆ·ï¼ˆå¯†ç å“ˆå¸Œï¼‰
            DB-->>API: ç”¨æˆ·åˆ›å»ºæˆåŠŸ
            API->>API: ç”ŸæˆJWT Token
            API-->>FE: è¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯
            FE->>FE: å­˜å‚¨Tokenåˆ°Pinia
            FE-->>U: æ³¨å†ŒæˆåŠŸï¼Œè·³è½¬é¦–é¡µ
        end
    end
    
    rect rgb(220, 240, 200)
        Note over U,DB: ç”¨æˆ·ç™»å½•æµç¨‹
        U->>FE: è¾“å…¥ç”¨æˆ·åå¯†ç 
        FE->>API: POST /api/v1/auth/login
        API->>DB: æŸ¥è¯¢ç”¨æˆ·
        API->>API: éªŒè¯å¯†ç 
        alt éªŒè¯å¤±è´¥
            API-->>FE: 401 æœªæˆæƒ
            FE-->>U: æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        else éªŒè¯æˆåŠŸ
            API->>API: ç”ŸæˆJWT Token
            API-->>FE: è¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯
            FE->>FE: å­˜å‚¨Tokenåˆ°Pinia
            FE-->>U: ç™»å½•æˆåŠŸï¼Œè·³è½¬é¦–é¡µ
        end
    end
```

## 3. OCRè¯†åˆ«å®Œæ•´æµç¨‹

```mermaid
flowchart TD
    Start([ç”¨æˆ·å¼€å§‹]) --> Upload{é€‰æ‹©è¾“å…¥æ–¹å¼}
    
    Upload -->|æ‹ç…§| Camera[è°ƒç”¨ç›¸æœº]
    Upload -->|ä¸Šä¼ å›¾ç‰‡| FileSelect[é€‰æ‹©æ–‡ä»¶]
    
    Camera --> Capture[æ‹æ‘„ç…§ç‰‡]
    FileSelect --> ValidateFile[éªŒè¯æ–‡ä»¶]
    Capture --> ValidateFile
    
    ValidateFile --> CheckFormat{æ£€æŸ¥æ ¼å¼}
    CheckFormat -->|ä¸æ”¯æŒ| Error1[æ˜¾ç¤ºé”™è¯¯]
    CheckFormat -->|æ”¯æŒ| CheckSize{æ£€æŸ¥å¤§å°}
    
    CheckSize -->|è¶…è¿‡é™åˆ¶| Error2[æ˜¾ç¤ºé”™è¯¯]
    CheckSize -->|ç¬¦åˆè¦æ±‚| UploadAPI[POST /api/v1/upload]
    
    UploadAPI --> SaveFile[ä¿å­˜æ–‡ä»¶åˆ°æœåŠ¡å™¨]
    SaveFile --> CreateRecord[åˆ›å»ºä¸Šä¼ è®°å½•]
    CreateRecord --> ReturnFileID[è¿”å›æ–‡ä»¶ID]
    
    ReturnFileID --> OCRRequest[POST /api/v1/ocr/recognize]
    OCRRequest --> LoadImage[åŠ è½½å›¾ç‰‡]
    LoadImage --> ValidateImage{éªŒè¯å›¾ç‰‡}
    
    ValidateImage -->|æ— æ•ˆ| Error3[è¿”å›é”™è¯¯]
    ValidateImage -->|æœ‰æ•ˆ| InitOCR[åˆå§‹åŒ–PaddleOCR]
    
    InitOCR --> RecognizeText[è¯†åˆ«æ–‡å­—]
    RecognizeText --> ExtractResult[æå–è¯†åˆ«ç»“æœ]
    ExtractResult --> UpdateStatus[æ›´æ–°æ–‡ä»¶çŠ¶æ€]
    
    UpdateStatus --> ShowPreview[æ˜¾ç¤ºè¯†åˆ«ç»“æœé¢„è§ˆ]
    ShowPreview --> UserEdit{ç”¨æˆ·æ˜¯å¦ç¼–è¾‘?}
    
    UserEdit -->|æ˜¯| EditText[ç¼–è¾‘æ–‡æœ¬]
    UserEdit -->|å¦| FinalText[ä½¿ç”¨åŸå§‹æ–‡æœ¬]
    
    EditText --> SaveEdit[POST /api/v1/ocr/edit]
    SaveEdit --> FinalText
    
    FinalText --> NextStep[è¿›å…¥åˆ†ç±»æµç¨‹]
    
    Error1 --> End([ç»“æŸ])
    Error2 --> End
    Error3 --> End
    
    style Start fill:#4CAF50
    style NextStep fill:#2196F3
    style End fill:#f44336
    style RecognizeText fill:#FF9800
```

## 4. AIåˆ†ç±»æµç¨‹

```mermaid
flowchart TD
    Start([æ¥æ”¶OCRæ–‡æœ¬]) --> ClassifyAPI[POST /api/v1/classify]
    
    ClassifyAPI --> TryLLM{å°è¯•LLMåˆ†ç±»}
    
    TryLLM -->|LLMå¯ç”¨| LLMClassify[è°ƒç”¨LLM API]
    TryLLM -->|LLMä¸å¯ç”¨| RuleClassify[ä½¿ç”¨è§„åˆ™åˆ†ç±»]
    
    LLMClassify --> ParseLLM[è§£æLLMå“åº”]
    ParseLLM --> ExtractInfo[æå–ç»“æ„åŒ–ä¿¡æ¯]
    
    RuleClassify --> CheckKeywords[æ£€æŸ¥å…³é”®è¯]
    CheckKeywords --> CheckDateTime[æ£€æŸ¥æ—¥æœŸæ—¶é—´]
    CheckDateTime --> CalculateScore[è®¡ç®—ç½®ä¿¡åº¦]
    
    ExtractInfo --> CheckConfidence{ç½®ä¿¡åº¦æ£€æŸ¥}
    CalculateScore --> CheckConfidence
    
    CheckConfidence -->|é«˜ç½®ä¿¡åº¦ >= 0.7| AutoClassify[è‡ªåŠ¨åˆ†ç±»]
    CheckConfidence -->|ä½ç½®ä¿¡åº¦ < 0.7| ManualSelect[éœ€è¦æ‰‹åŠ¨é€‰æ‹©]
    
    AutoClassify --> DetermineType{åˆ¤æ–­ç±»å‹}
    ManualSelect --> UserChoice[ç”¨æˆ·é€‰æ‹©ç±»å‹]
    
    UserChoice --> ManualAPI[POST /api/v1/classify/manual]
    ManualAPI --> DetermineType
    
    DetermineType -->|æ—¥ç¨‹| ExtractSchedule[æå–æ—¥ç¨‹ä¿¡æ¯]
    DetermineType -->|å¤‡å¿˜å½•| ExtractMemo[æå–å¤‡å¿˜å½•ä¿¡æ¯]
    
    ExtractSchedule --> ScheduleData[ç»“æ„åŒ–æ—¥ç¨‹æ•°æ®]
    ExtractMemo --> MemoData[ç»“æ„åŒ–å¤‡å¿˜å½•æ•°æ®]
    
    ScheduleData --> SaveSchedule[ä¿å­˜åˆ°æ—¥ç¨‹]
    MemoData --> SaveMemo[ä¿å­˜åˆ°å¤‡å¿˜å½•]
    
    SaveSchedule --> Success([å®Œæˆ])
    SaveMemo --> Success
    
    style Start fill:#4CAF50
    style LLMClassify fill:#9C27B0
    style RuleClassify fill:#FF9800
    style Success fill:#2196F3
```

## 5. æ—¥ç¨‹ç®¡ç†æµç¨‹

```mermaid
flowchart TD
    Start([æ—¥ç¨‹ç®¡ç†]) --> Action{ç”¨æˆ·æ“ä½œ}
    
    Action -->|æŸ¥çœ‹åˆ—è¡¨| GetList[GET /api/v1/schedules]
    Action -->|åˆ›å»ºæ—¥ç¨‹| CreateForm[å¡«å†™æ—¥ç¨‹è¡¨å•]
    Action -->|ç¼–è¾‘æ—¥ç¨‹| EditForm[ç¼–è¾‘æ—¥ç¨‹è¡¨å•]
    Action -->|åˆ é™¤æ—¥ç¨‹| DeleteConfirm[ç¡®è®¤åˆ é™¤]
    
    GetList --> ApplyFilters{åº”ç”¨ç­›é€‰?}
    ApplyFilters -->|æ˜¯| FilterParams[æ·»åŠ æŸ¥è¯¢å‚æ•°]
    ApplyFilters -->|å¦| QueryDB1[æŸ¥è¯¢æ•°æ®åº“]
    FilterParams --> QueryDB1
    
    QueryDB1 --> SortResults[æ’åºç»“æœ]
    SortResults --> ReturnList[è¿”å›æ—¥ç¨‹åˆ—è¡¨]
    ReturnList --> DisplayList[æ˜¾ç¤ºæ—¥ç¨‹åˆ—è¡¨]
    
    CreateForm --> ValidateSchedule{éªŒè¯æ•°æ®}
    ValidateSchedule -->|æ— æ•ˆ| ShowError1[æ˜¾ç¤ºé”™è¯¯]
    ValidateSchedule -->|æœ‰æ•ˆ| PostSchedule[POST /api/v1/schedules]
    
    PostSchedule --> SaveSchedule[ä¿å­˜åˆ°æ•°æ®åº“]
    SaveSchedule --> ReturnSchedule[è¿”å›æ–°æ—¥ç¨‹]
    ReturnSchedule --> RefreshList1[åˆ·æ–°åˆ—è¡¨]
    
    EditForm --> ValidateEdit{éªŒè¯æ•°æ®}
    ValidateEdit -->|æ— æ•ˆ| ShowError2[æ˜¾ç¤ºé”™è¯¯]
    ValidateEdit -->|æœ‰æ•ˆ| PutSchedule[PUT /api/v1/schedules/:id]
    
    PutSchedule --> UpdateDB[æ›´æ–°æ•°æ®åº“]
    UpdateDB --> ReturnUpdated[è¿”å›æ›´æ–°åæ—¥ç¨‹]
    ReturnUpdated --> RefreshList2[åˆ·æ–°åˆ—è¡¨]
    
    DeleteConfirm --> DeleteAPI[DELETE /api/v1/schedules/:id]
    DeleteAPI --> RemoveDB[ä»æ•°æ®åº“åˆ é™¤]
    RemoveDB --> RefreshList3[åˆ·æ–°åˆ—è¡¨]
    
    DisplayList --> End([ç»“æŸ])
    RefreshList1 --> End
    RefreshList2 --> End
    RefreshList3 --> End
    ShowError1 --> End
    ShowError2 --> End
    
    style Start fill:#4CAF50
    style End fill:#2196F3
```

## 6. å¤‡å¿˜å½•ç®¡ç†æµç¨‹

```mermaid
flowchart TD
    Start([å¤‡å¿˜å½•ç®¡ç†]) --> Action{ç”¨æˆ·æ“ä½œ}
    
    Action -->|æŸ¥çœ‹åˆ—è¡¨| GetList[GET /api/v1/memos]
    Action -->|åˆ›å»ºå¤‡å¿˜å½•| CreateForm[å¡«å†™å¤‡å¿˜å½•è¡¨å•]
    Action -->|ç¼–è¾‘å¤‡å¿˜å½•| EditForm[ç¼–è¾‘å¤‡å¿˜å½•è¡¨å•]
    Action -->|åˆ é™¤å¤‡å¿˜å½•| DeleteConfirm[ç¡®è®¤åˆ é™¤]
    Action -->|æœç´¢| SearchForm[è¾“å…¥æœç´¢å…³é”®è¯]
    
    GetList --> ApplyFilters{åº”ç”¨ç­›é€‰?}
    ApplyFilters -->|æ ‡ç­¾ç­›é€‰| FilterByTag[æŒ‰æ ‡ç­¾ç­›é€‰]
    ApplyFilters -->|æ—¥æœŸç­›é€‰| FilterByDate[æŒ‰æ—¥æœŸç­›é€‰]
    ApplyFilters -->|æ— ç­›é€‰| QueryDB1[æŸ¥è¯¢æ•°æ®åº“]
    
    FilterByTag --> QueryDB1
    FilterByDate --> QueryDB1
    
    QueryDB1 --> SortResults[æ’åºç»“æœ]
    SortResults --> ReturnList[è¿”å›å¤‡å¿˜å½•åˆ—è¡¨]
    ReturnList --> DisplayList[æ˜¾ç¤ºå¤‡å¿˜å½•åˆ—è¡¨]
    
    CreateForm --> ValidateMemo{éªŒè¯æ•°æ®}
    ValidateMemo -->|æ— æ•ˆ| ShowError1[æ˜¾ç¤ºé”™è¯¯]
    ValidateMemo -->|æœ‰æ•ˆ| PostMemo[POST /api/v1/memos]
    
    PostMemo --> SaveMemo[ä¿å­˜åˆ°æ•°æ®åº“]
    SaveMemo --> ProcessTags[å¤„ç†æ ‡ç­¾]
    ProcessTags --> ReturnMemo[è¿”å›æ–°å¤‡å¿˜å½•]
    ReturnMemo --> RefreshList1[åˆ·æ–°åˆ—è¡¨]
    
    EditForm --> ValidateEdit{éªŒè¯æ•°æ®}
    ValidateEdit -->|æ— æ•ˆ| ShowError2[æ˜¾ç¤ºé”™è¯¯]
    ValidateEdit -->|æœ‰æ•ˆ| PutMemo[PUT /api/v1/memos/:id]
    
    PutMemo --> UpdateDB[æ›´æ–°æ•°æ®åº“]
    UpdateDB --> UpdateTags[æ›´æ–°æ ‡ç­¾]
    UpdateTags --> ReturnUpdated[è¿”å›æ›´æ–°åå¤‡å¿˜å½•]
    ReturnUpdated --> RefreshList2[åˆ·æ–°åˆ—è¡¨]
    
    DeleteConfirm --> DeleteAPI[DELETE /api/v1/memos/:id]
    DeleteAPI --> RemoveDB[ä»æ•°æ®åº“åˆ é™¤]
    RemoveDB --> RefreshList3[åˆ·æ–°åˆ—è¡¨]
    
    SearchForm --> SearchAPI[GET /api/v1/search]
    SearchAPI --> FullTextSearch[å…¨æ–‡æœç´¢]
    FullTextSearch --> ReturnResults[è¿”å›æœç´¢ç»“æœ]
    ReturnResults --> DisplayResults[æ˜¾ç¤ºæœç´¢ç»“æœ]
    
    DisplayList --> End([ç»“æŸ])
    DisplayResults --> End
    RefreshList1 --> End
    RefreshList2 --> End
    RefreshList3 --> End
    ShowError1 --> End
    ShowError2 --> End
    
    style Start fill:#4CAF50
    style End fill:#2196F3
    style FullTextSearch fill:#FF9800
```

## 7. æ•°æ®æ¨¡å‹å…³ç³»å›¾

```mermaid
erDiagram
    USER ||--o{ UPLOADED_FILE : uploads
    USER ||--o{ SCHEDULE : creates
    USER ||--o{ MEMO : creates
    
    USER {
        uuid id PK
        string username UK
        string email UK
        string password_hash
        datetime created_at
        datetime updated_at
    }
    
    UPLOADED_FILE {
        uuid id PK
        uuid user_id FK
        string filename
        string file_path
        string file_type
        int file_size
        string status
        datetime created_at
    }
    
    SCHEDULE {
        uuid id PK
        uuid user_id FK
        string title
        text description
        datetime start_time
        datetime end_time
        string location
        string reminder
        datetime created_at
        datetime updated_at
    }
    
    MEMO {
        uuid id PK
        uuid user_id FK
        string title
        text content
        json tags
        datetime created_at
        datetime updated_at
    }
```

## 8. å®Œæ•´ä¸šåŠ¡æµç¨‹å›¾

```mermaid
flowchart TB
    Start([ç”¨æˆ·å¯åŠ¨åº”ç”¨]) --> CheckAuth{æ£€æŸ¥ç™»å½•çŠ¶æ€}
    
    CheckAuth -->|æœªç™»å½•| LoginPage[æ˜¾ç¤ºç™»å½•é¡µé¢]
    CheckAuth -->|å·²ç™»å½•| HomePage[æ˜¾ç¤ºé¦–é¡µ]
    
    LoginPage --> LoginAction{ç”¨æˆ·æ“ä½œ}
    LoginAction -->|ç™»å½•| DoLogin[æ‰§è¡Œç™»å½•]
    LoginAction -->|æ³¨å†Œ| DoRegister[æ‰§è¡Œæ³¨å†Œ]
    
    DoLogin --> AuthSuccess{è®¤è¯æˆåŠŸ?}
    DoRegister --> AuthSuccess
    
    AuthSuccess -->|å¤±è´¥| LoginPage
    AuthSuccess -->|æˆåŠŸ| HomePage
    
    HomePage --> MainAction{é€‰æ‹©åŠŸèƒ½}
    
    MainAction -->|ä¸Šä¼ /æ‹ç…§| UploadFlow[æ–‡ä»¶ä¸Šä¼ æµç¨‹]
    MainAction -->|æŸ¥çœ‹æ—¥ç¨‹| ScheduleList[æ—¥ç¨‹åˆ—è¡¨]
    MainAction -->|æŸ¥çœ‹å¤‡å¿˜å½•| MemoList[å¤‡å¿˜å½•åˆ—è¡¨]
    MainAction -->|æœç´¢| SearchFlow[æœç´¢æµç¨‹]
    
    UploadFlow --> OCRFlow[OCRè¯†åˆ«æµç¨‹]
    OCRFlow --> ClassifyFlow[AIåˆ†ç±»æµç¨‹]
    
    ClassifyFlow --> SaveType{ä¿å­˜ç±»å‹}
    SaveType -->|æ—¥ç¨‹| SaveSchedule[ä¿å­˜ä¸ºæ—¥ç¨‹]
    SaveType -->|å¤‡å¿˜å½•| SaveMemo[ä¿å­˜ä¸ºå¤‡å¿˜å½•]
    
    SaveSchedule --> ScheduleList
    SaveMemo --> MemoList
    
    ScheduleList --> ScheduleAction{æ—¥ç¨‹æ“ä½œ}
    ScheduleAction -->|æŸ¥çœ‹| ViewSchedule[æŸ¥çœ‹è¯¦æƒ…]
    ScheduleAction -->|ç¼–è¾‘| EditSchedule[ç¼–è¾‘æ—¥ç¨‹]
    ScheduleAction -->|åˆ é™¤| DeleteSchedule[åˆ é™¤æ—¥ç¨‹]
    ScheduleAction -->|ç­›é€‰| FilterSchedule[ç­›é€‰æ—¥ç¨‹]
    
    MemoList --> MemoAction{å¤‡å¿˜å½•æ“ä½œ}
    MemoAction -->|æŸ¥çœ‹| ViewMemo[æŸ¥çœ‹è¯¦æƒ…]
    MemoAction -->|ç¼–è¾‘| EditMemo[ç¼–è¾‘å¤‡å¿˜å½•]
    MemoAction -->|åˆ é™¤| DeleteMemo[åˆ é™¤å¤‡å¿˜å½•]
    MemoAction -->|ç­›é€‰| FilterMemo[ç­›é€‰å¤‡å¿˜å½•]
    
    SearchFlow --> SearchResults[æ˜¾ç¤ºæœç´¢ç»“æœ]
    SearchResults --> ResultAction{ç»“æœæ“ä½œ}
    ResultAction -->|æŸ¥çœ‹æ—¥ç¨‹| ViewSchedule
    ResultAction -->|æŸ¥çœ‹å¤‡å¿˜å½•| ViewMemo
    
    ViewSchedule --> HomePage
    EditSchedule --> HomePage
    DeleteSchedule --> HomePage
    FilterSchedule --> ScheduleList
    
    ViewMemo --> HomePage
    EditMemo --> HomePage
    DeleteMemo --> HomePage
    FilterMemo --> MemoList
    
    style Start fill:#4CAF50
    style HomePage fill:#2196F3
    style OCRFlow fill:#FF9800
    style ClassifyFlow fill:#9C27B0
```

## 9. æŠ€æœ¯æ ˆäº¤äº’å›¾

```mermaid
graph LR
    subgraph "å‰ç«¯æŠ€æœ¯æ ˆ"
        Vue[Vue 3 Composition API]
        TS[TypeScript]
        Tailwind[Tailwind CSS]
        Router[Vue Router]
        Pinia[Pinia Store]
        Axios[Axios]
    end
    
    subgraph "åç«¯æŠ€æœ¯æ ˆ"
        FastAPI[FastAPI Framework]
        SQLAlchemy[SQLAlchemy ORM]
        Pydantic[Pydantic Schemas]
        JWT[JWT Auth]
        PaddleOCR[PaddleOCR Engine]
        LLM[LLM Service]
    end
    
    subgraph "æ•°æ®å­˜å‚¨"
        SQLite[(SQLite DB)]
        FileSystem[File System]
    end
    
    Vue --> TS
    Vue --> Router
    Vue --> Pinia
    TS --> Axios
    Axios --> FastAPI
    
    FastAPI --> Pydantic
    FastAPI --> JWT
    FastAPI --> SQLAlchemy
    FastAPI --> PaddleOCR
    FastAPI --> LLM
    
    SQLAlchemy --> SQLite
    PaddleOCR --> FileSystem
    
    style Vue fill:#42b883
    style FastAPI fill:#009688
    style SQLite fill:#ff9800
```

## 10. éƒ¨ç½²æ¶æ„å›¾

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯"
        Browser[æµè§ˆå™¨]
        Mobile[ç§»åŠ¨è®¾å¤‡]
    end
    
    subgraph "å‰ç«¯æœåŠ¡å™¨"
        Nginx[Nginx]
        VueApp[Vueåº”ç”¨]
    end
    
    subgraph "åç«¯æœåŠ¡å™¨"
        Uvicorn[Uvicorn]
        FastAPIApp[FastAPIåº”ç”¨]
    end
    
    subgraph "æ•°æ®å±‚"
        DB[(æ•°æ®åº“)]
        Storage[æ–‡ä»¶å­˜å‚¨]
    end
    
    Browser --> Nginx
    Mobile --> Nginx
    Nginx --> VueApp
    VueApp --> Uvicorn
    Uvicorn --> FastAPIApp
    FastAPIApp --> DB
    FastAPIApp --> Storage
    
    style Browser fill:#4CAF50
    style Nginx fill:#009688
    style Uvicorn fill:#FF9800
    style DB fill:#f44336
```

---

## ä½¿ç”¨è¯´æ˜

è¿™äº›æµç¨‹å›¾å±•ç¤ºäº†æ‰‹å†™ç®¡ç†åŠ©æ‰‹é¡¹ç›®çš„å„ä¸ªæ–¹é¢ï¼š

1. **ç³»ç»Ÿæ•´ä½“æ¶æ„å›¾** - å±•ç¤ºå‰åç«¯æŠ€æœ¯æ ˆå’Œæ•°æ®å±‚çš„å…³ç³»
2. **ç”¨æˆ·è®¤è¯æµç¨‹** - è¯¦ç»†çš„æ³¨å†Œå’Œç™»å½•æ—¶åºå›¾
3. **OCRè¯†åˆ«å®Œæ•´æµç¨‹** - ä»ä¸Šä¼ åˆ°è¯†åˆ«çš„å®Œæ•´æµç¨‹
4. **AIåˆ†ç±»æµç¨‹** - LLMå’Œè§„åˆ™åˆ†ç±»çš„å†³ç­–æµç¨‹
5. **æ—¥ç¨‹ç®¡ç†æµç¨‹** - CRUDæ“ä½œçš„å®Œæ•´æµç¨‹
6. **å¤‡å¿˜å½•ç®¡ç†æµç¨‹** - åŒ…å«æ ‡ç­¾å’Œæœç´¢çš„ç®¡ç†æµç¨‹
7. **æ•°æ®æ¨¡å‹å…³ç³»å›¾** - æ•°æ®åº“å®ä½“å…³ç³»
8. **å®Œæ•´ä¸šåŠ¡æµç¨‹å›¾** - ç”¨æˆ·ä½¿ç”¨åº”ç”¨çš„å®Œæ•´è·¯å¾„
9. **æŠ€æœ¯æ ˆäº¤äº’å›¾** - å„æŠ€æœ¯ç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»
10. **éƒ¨ç½²æ¶æ„å›¾** - ç”Ÿäº§ç¯å¢ƒçš„éƒ¨ç½²ç»“æ„

ä½ å¯ä»¥åœ¨æ”¯æŒMermaidçš„MarkdownæŸ¥çœ‹å™¨ä¸­æŸ¥çœ‹è¿™äº›å›¾è¡¨ï¼Œæˆ–è€…ä½¿ç”¨åœ¨çº¿å·¥å…·å¦‚ [Mermaid Live Editor](https://mermaid.live/) æ¥æ¸²æŸ“å’Œç¼–è¾‘è¿™äº›å›¾è¡¨ã€‚
