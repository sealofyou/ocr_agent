# OCR识别结果保存到日程/备忘录功能

## 功能说明

现在OCR识别完成后，可以直接将识别的文本保存为日程或备忘录。系统会使用AI自动分析文本内容，智能推荐应该保存为日程还是备忘录。

## 功能特性

### 1. 智能分类
- **自动分析**: OCR识别完成后，自动调用LLM分类服务
- **智能推荐**: 根据文本内容判断是日程还是备忘录
- **置信度显示**: 显示AI判断的置信度百分比
- **可视化提示**: 用图标和颜色提示分类结果

### 2. 一键保存
- **保存为日程**: 点击"📅 保存为日程"按钮
  - 自动提取日期、时间信息
  - 保存后跳转到日程页面
  
- **保存为备忘录**: 点击"📝 保存为备忘录"按钮
  - 自动生成摘要
  - 提取相关标签
  - 保存后跳转到备忘录页面

### 3. 编辑后重新分类
- 编辑OCR识别结果后，系统会自动重新分类
- 确保分类建议始终与当前文本内容匹配

## 使用流程

```
1. 上传图片
   ↓
2. 点击"开始识别"
   ↓
3. OCR识别文字
   ↓
4. AI自动分类（显示建议）
   ↓
5. 用户选择保存方式
   ├─ 保存为日程 → 跳转到日程页面
   └─ 保存为备忘录 → 跳转到备忘录页面
```

## 技术实现

### 前端新增文件
- `frontend/src/api/classification.ts` - 分类API客户端

### 前端修改文件
- `frontend/src/views/OCR.vue` - OCR页面
  - 添加分类功能
  - 添加保存到日程/备忘录功能
  - 显示AI分类建议
  
- `frontend/src/components/OCRPreview.vue` - OCR预览组件
  - 添加保存按钮
  - 新增事件: `saveAsSchedule`, `saveAsMemo`

### 后端API
使用现有的分类API:
- `POST /api/v1/classify` - 自动分类文本
- `POST /api/v1/schedules` - 创建日程
- `POST /api/v1/memos` - 创建备忘录

## 分类逻辑

### 日程特征
- 包含日期时间信息
- 包含"会议"、"约"、"提醒"等关键词
- 描述未来的活动或事件

### 备忘录特征
- 记录性内容
- 知识点、想法、笔记
- 不包含明确的时间信息

## 示例

### 示例1: 日程
**OCR识别文本**:
```
明天下午3点开会
地点: 会议室A
主题: 项目进度讨论
```

**AI分类**: 日程 (置信度: 95%)

**保存结果**:
- 日期: 明天的日期
- 时间: 15:00
- 描述: 会议室A - 项目进度讨论

### 示例2: 备忘录
**OCR识别文本**:
```
Python装饰器使用要点:
1. @符号语法糖
2. 可以修改函数行为
3. 常用于日志、权限检查
```

**AI分类**: 备忘录 (置信度: 92%)

**保存结果**:
- 内容: 完整文本
- 摘要: Python装饰器使用要点
- 标签: [Python, 编程]

## 注意事项

1. **需要LLM服务**: 确保后端LLM服务正常运行
   - 检查 `backend/.env` 中的 `LLM_ENABLED=true`
   - 确认 `LLM_API_URL` 配置正确

2. **分类失败处理**: 如果LLM分类失败，会使用规则方法作为后备

3. **手动选择**: 用户可以忽略AI建议，手动选择保存类型

4. **编辑功能**: 可以先编辑识别结果，再保存

## 未来改进

- [ ] 添加批量保存功能
- [ ] 支持保存时编辑提取的信息
- [ ] 添加保存历史记录
- [ ] 支持从日程/备忘录页面查看原始图片
- [ ] 优化分类算法，提高准确率
