# OCR保存功能测试指南

## 测试前准备

### 1. 确保服务运行
```bash
# 启动后端
start_backend.bat

# 启动前端
start_frontend.bat

# 启动LLM服务（如果使用）
start_qwen_llm.bat
# 或
start_ollama_llm.bat
```

### 2. 检查配置
确认 `backend/.env` 中:
```
LLM_ENABLED=true
LLM_API_URL=http://localhost:3001/v1/chat/completions
```

## 测试步骤

### 测试1: 保存日程类文本

1. **访问OCR页面**
   - 打开浏览器: `http://192.168.1.4:5173/`
   - 登录账号
   - 点击导航栏的"文字识别"

2. **上传包含日程信息的图片**
   - 准备一张包含日期时间的图片，例如:
     ```
     明天下午2点
     产品评审会议
     会议室B
     ```

3. **识别文字**
   - 点击"开始识别"按钮
   - 等待识别完成

4. **查看分类建议**
   - 应该显示: "AI建议保存为**日程** (置信度: XX%)"
   - 图标应该是 📅

5. **保存为日程**
   - 点击"📅 保存为日程"按钮
   - 应该提示"已保存为日程"
   - 自动跳转到日程页面
   - 在日程列表中应该能看到新创建的日程

### 测试2: 保存备忘录类文本

1. **上传包含笔记内容的图片**
   - 准备一张包含笔记的图片，例如:
     ```
     学习笔记
     1. Vue3使用Composition API
     2. 响应式原理基于Proxy
     3. setup函数是入口
     ```

2. **识别文字**
   - 点击"开始识别"

3. **查看分类建议**
   - 应该显示: "AI建议保存为**备忘录** (置信度: XX%)"
   - 图标应该是 📝

4. **保存为备忘录**
   - 点击"📝 保存为备忘录"按钮
   - 应该提示"已保存为备忘录"
   - 自动跳转到备忘录页面
   - 在备忘录列表中应该能看到新创建的备忘录

### 测试3: 编辑后保存

1. **识别文字后点击"编辑"**
   - 修改识别的文本内容
   - 点击"保存"

2. **查看分类建议更新**
   - 分类建议应该根据编辑后的内容更新

3. **选择保存方式**
   - 可以选择保存为日程或备忘录

### 测试4: 手机端测试

1. **手机访问**
   - 手机浏览器打开: `http://192.168.1.4:5173/`
   - 登录账号

2. **拍照上传**
   - 点击上传按钮
   - 选择"拍照"
   - 拍摄包含文字的照片

3. **识别并保存**
   - 识别文字
   - 查看分类建议
   - 保存为日程或备忘录

## 预期结果

### 成功标准
- ✅ OCR识别成功
- ✅ 显示AI分类建议
- ✅ 分类建议合理（日程类文本建议为日程，笔记类文本建议为备忘录）
- ✅ 点击保存按钮后成功保存
- ✅ 自动跳转到对应页面
- ✅ 在列表中能看到新创建的项目

### 可能的问题

#### 问题1: 不显示分类建议
**原因**: LLM服务未启动或配置错误
**解决**: 
- 检查LLM服务是否运行
- 查看后端日志是否有错误
- 确认 `backend/.env` 配置正确

#### 问题2: 保存失败
**原因**: 
- 未登录
- 网络连接问题
- 后端服务异常

**解决**:
- 确认已登录
- 检查浏览器控制台错误信息
- 查看后端日志

#### 问题3: 分类不准确
**原因**: LLM模型判断偏差
**解决**:
- 用户可以忽略建议，手动选择保存类型
- 后续可以优化提示词或使用更好的模型

## 调试技巧

### 查看浏览器控制台
```javascript
// 打开浏览器开发者工具 (F12)
// 查看 Console 标签
// 应该能看到:
// - "分类结果: {type: 'schedule', confidence: 0.95, ...}"
```

### 查看网络请求
```
1. 打开开发者工具 Network 标签
2. 识别文字时应该看到:
   - POST /api/v1/ocr/recognize
   - POST /api/v1/classify
3. 保存时应该看到:
   - POST /api/v1/schedules 或
   - POST /api/v1/memos
```

### 查看后端日志
```bash
# 后端控制台应该显示:
# - "用户 xxx 对文件 xxx 进行OCR识别"
# - "用户 xxx 对文本进行分类: 类型=schedule, 置信度=0.95"
```

## 测试数据建议

### 日程类文本示例
```
明天上午10点 团队会议
2024年1月15日 14:00 客户拜访
下周三 产品发布会
提醒: 周五交报告
```

### 备忘录类文本示例
```
购物清单: 牛奶、面包、鸡蛋
Python学习笔记
重要联系人: 张三 13800138000
会议要点总结
```
